# “心青年”智能体平台 功能文档

## 文档日期

2025-12-27

## 项目目的

基于现有研究与实践团队需求，快速交付可运行的 MVP：
- 为孤独症（自闭症）患者家属提供24小时可用的权威知识检索与基础咨询；
- 搭建专业内容管理后台，便于专家/康复师维护知识条目与多媒体资源；
- 提供便捷的工单转人工机制，保障高风险问题能及时人工跟进；
- 优先保证可落地、易维护与合规（隐私最小化）。

## 目标用户

- 主要：孤独症患者的直系家属（家长/监护人），需要即时、可执行的照护建议；
- 次要：康复师、儿科/精神科医生与志愿者服务团队；
- 用户特征：偏好简单步骤、可跟随的处置卡与可信来源；在夜间或急性情绪事件时需要快速、明确建议。

## 功能概述

遵循“先小而精、可验证”的路线：
- 第一阶段（MVP）：知识库问答 + 专业内容管理后台 + 常见场景指南 + 咨询工单；
- 第二阶段：引入向量检索（RAG）、患者画像与个性化建议；
- 第三阶段：多模态情绪感知与互动式陪伴。

---

## 第一阶段功能（简易核心功能）

### 功能列表

|功能名称|功能描述|优先级|实现难度|
|---|---:|---:|---:|
|知识库问答（FAQ & 基础检索）|结构化/半结构化知识条目支持自然语言查询，返回参考答案与来源。|高|低|
|专业内容管理后台|专家/康复师创建、编辑、审核、版本管理条目及多媒体（图片/短视频）。|高|低|
|常见场景指南|按年龄与情境（睡眠、入学、情绪爆发）提供一页式处置卡和实施步骤。|高|低|
|咨询工单/留言|用户可提交问题并选择是否需要人工跟进，支持工单状态和指派。|中|低|

### 功能详情

#### 知识库问答（FAQ & 基础检索）
- 具体需求：
  - 支持关键字检索与简单的自然语言问答；
  - 答案需返回：简短建议（1-3步）、可信来源（条目ID/上传者）、置信度标签（示例：专家条目/自动生成）。
  - 优先使用结构化条目（title, summary, steps[], tags, age_range, references[]）。
- 用户场景：家长在夜间遇到情绪爆发，搜索“孩子情绪失控怎么办”，系统返回快速缓解步骤与后续观察点。
- 验收标准：在20秒内返回首条建议；对 50 条常见问答人工评审通过率 ≥ 80%。
- 最小实现建议（工程要点）：
  - 数据库表 `knowledge_item(id, title, summary, steps_json, tags, age_range, author_id, status)`；
  - FastAPI 路由：`GET /api/v1/knowledge/search?q=...`，`GET /api/v1/knowledge/{id}`；
  - 简单全文检索可用 MySQL + LIKE 或引入 SQLite FTS 作为临时方案；后续替换为向量检索。

#### 专业内容管理后台
- 具体需求：角色化（管理员/专家/审核员）、条目创建/编辑/审核、版本历史、文件上传（图片/视频）。
- 用户场景：康复师上传训练视频并标注适用年龄与注意事项，审核员审阅通过后发布。
- 验收标准：支持条目创建/编辑/审核流程；文件上传后能在前端预览。
- 最小实现建议：
  - 数据模型：`user(id, role)`, `knowledge_item`, `media(id, path, type)`；
  - API 路由：`POST /api/v1/admin/knowledge`、`PUT /api/v1/admin/knowledge/{id}`、`POST /api/v1/admin/media`；
  - 存储：开发阶段可先使用本地磁盘 `/uploads`，生产建议 S3 或兼容对象存储。

#### 常见场景指南
- 具体需求：为高频情境生成可执行步骤、所需材料、注意事项与“快速处置卡” PDF/打印视图。
- 用户场景：家长查询“入学适应”，获取一页式执行清单与 3 个简短练习。
- 验收标准：每个场景提供 ≤1 页的标准化指南，用户满意度 ≥ 80%（试点反馈）。

#### 咨询工单/留言
- 具体需求：用户提交问题，填写是否需要人工联系，工单可标注优先级、指派专家并保留对话记录。
- 用户场景：自动回复无法解决的问题创建工单并在工作时间内转给值班专家。
- 验收标准：能创建/更新工单并向指定邮箱或后台通知专家。
- 最小实现建议：
  - 表：`ticket(id, user_id, question, priority, status, assigned_to, created_at)`；
  - API：`POST /api/v1/tickets`、`GET /api/v1/tickets/{id}`、`PUT /api/v1/tickets/{id}/assign`。

### 阶段目标

交付后能提供：可检索的专家知识与场景化指南，支持专家在线维护内容，并能把复杂或高风险问题转为人工工单。

---

## 第二阶段功能（中等难度功能）

### 功能列表

|功能名称|功能描述|优先级|实现难度|
|---|---:|---:|---:|
|检索增强生成（RAG）|文档向量化检索 + 生成模型，用以提升复杂问题的回答质量并返回证据片段。|高|中|
|用户/患者画像与历史记录|保存偏好、既往干预、敏感点，用于个性化回答。|高|中|
|个性化干预计划生成|基于画像自动生成分阶段干预方案，专家复核后发布。|中|中|
|人工客服/专家接入系统|支持工单升级与在线会话，记录专家复核历史。|中|中|

### 功能详情（要点）
- RAG 实施建议：
  - 使用向量数据库（如 Milvus、Weaviate、FAISS）或开源向量索引（简易阶段可用 SQLite+annoy）；
  - 建立检索 pipeline：query→retriever(top-k docs)→生成模型(带来源引用)；
  - 验收：复杂问题集下，专家主观评分提升明显且引用正确。
- 用户画像最小字段：`patient(id, age, diagnosis_summary, allergies, preferences, history_entries[])`；
- 隐私要求：仅收集必要字段，提供导出/删除接口，数据默认脱敏存储。

---

## 第三阶段功能（高级功能）

### 功能列表

|功能名称|功能描述|优先级|实现难度|
|---|---:|---:|---:|
|多模态情绪与行为感知|通过短视频/音频做情绪检测，提供实时干预建议（合规前提）。|中|高|
|互动式陪伴模块|绘本、音乐与简单游戏交互，基于偏好调整节奏。|中|高|
|长期效果追踪与评估|基于干预数据生成效果报告，支持科研回顾。|低|高|

### 注意事项
- 多模态功能需严格遵守隐私法规与伦理审批；首阶段建议仅做本地/用户同意下的实验性原型。

---

## 功能依赖关系

- `专业内容管理后台` -> 首先建立（内容来源），为 `知识库问答` 与后续 `RAG` 提供数据；
- `知识库问答` -> 为 `咨询工单/人工接入` 提供上下文，减少人工负荷；
- `用户画像` -> 为 `个性化干预计划` 与 `互动式陪伴` 提供输入；
- `RAG` -> 依赖文档索引与检索器，实现第二阶段后再接入生成模型。

## 潜在风险

|风险描述|影响范围|缓解建议|
|---|---|---|
|错误或不完整的医疗建议|问答/RAG 的核心风险|对高风险问题强制转人工；在关键建议处注明“需专家确认”；设置模型输出可信度阈值并标注来源|
|数据隐私与合规风险|患者画像、多模态数据|最小化收集；用户明确同意；敏感数据加密存储；提供数据导出/删除接口|
|模型“幻觉”或来源错配|RAG/生成模型|检索并展示证据片段；对生成内容进行专家复核流程|
|内容更新滞后|知识库过时|建立版本与过期标签，定期专家复核计划|

## 完成后

1. 保存路径：`docs/2025-12-27-孤独症关怀智能体平台-功能文档-落地版.md`。
2. 核心阶段与关键功能：第一阶段优先交付 `知识库问答 + 专业内容管理后台 + 常见场景指南 + 咨询工单`，以实现可用 MVP；第二阶段引入 RAG 与画像；第三阶段做多模态与陪伴。 
3. 建议下一步（开发角度）：
  - 优先分解第一阶段为 2 周迭代任务（API + DB 模型 + 后台 CRUD + 基础前端列表/详情页 + 简单检索）；
  - 同时准备内容填充池（先由团队整理 100 条高频问答与 20 个场景指南）；
  - 选定短期检索方案（MySQL/SQLite FTS）并列出向量化替换计划。
4. 需要我继续的工作（请选择）：
  - 将第一阶段拆分为 Issue/Trello 样式的开发任务清单；
  - 为 `FastAPI` 生成初步的路由与 Pydantic 模型草案；
  - 帮你把文件提交到 git（创建分支并提交）。

---

文件编写者：项目产品/技术负责人（草稿）

如需我把文档再细化为开发任务或生成 FastAPI 模板，请告诉我你想先做哪项。